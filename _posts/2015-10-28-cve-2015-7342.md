---
date: 2015-10-28 10:03:00
title: CVE-2015-7342 - Multiple SQL Injection in JNews Joomla Component
category: advisory
---


# 1. Vulnerability Properties

* **Title:** Multiple SQL Injection in JNews Joomla Component
* **CVE ID:** CVE-2015-7342
* **CVSSv3 Base Score:** 6.6 (AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:L)
* **Vendor:** Joobi
* **Products:** JNews Core(8.3.1)
* **Advisory Release Date:** 28 October 2015
* **Advisory URL:** https://labs.integrity.pt/advisories/cve-2015-7342
* **Credits:** Discovery by Fábio Pires <fp[at]integrity.pt>, Filipe Reis <fr[at]integrity.pt>, Vitor Oliveira <vo[at]integrity.pt>

# 2. Vulnerability Summary

JNews component is vulnerable to Multiple SQL Injection, inside the backoffice.

# 3. Technical Details

## #1 – SQL Injection (error based):

To replicate the issue go to:

> Administration > Components > JNews > Templates > <choose a template> > upload thumbnail

![image1]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/1.png)

* Upload a thumbnail and grab the request and inject into the filename parameter.

![image2]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/2.png)

With this we get the following response (as you can see on the response we broke the SQL query):

![image3]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/3.png)

Now we inject with our SQL query into the parameter **filename**:

![image4]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/4.png)

And we get the response with the proof.

![image5]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/5.png)


## #2 – SQL Injection (error based):

To replicate the issue go to:

> Administration > Components > JNews > Queue > **Search Field**

![image6]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/6.png)

Do a search and grab the request, the injection point is the parameter **mailingsearch**:

![image7]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/7.png)

With this we get the following response (as you can see on the response we broke the SQL query):

![image8]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/8.png)

Now we inject with our SQL query into the parameter **mailingsearch**:

![image9]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/9.png)

And we get the response with the proof.

![image10]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/10.png)


## #3 – SQL Injection (error based):

To replicate the issue go to:

> Administration > Components > JNews > Subscribers > **Search Field**<br/>
> Administration > Components > JNews > Newsletters > **Search Field**

![image11]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/11.png)

Do a search and grab the request, the injection point is the parameter **emailsearch**:

![image12]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/12.png)

With this we get the following response (as you can see on the response we broke the SQL query):

![image13]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/13.png)

Now we inject with our SQL query into the parameter **emailsearch**:

![image14]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/14.png)

And we get the response with the proof.

![image15]({{ site.url }}{{ site.baseurl }}/images/posts/2015/10/cve-2015-7342/15.png)

# 4. Vulnerable Versions

* JNews 8.3.1

# 5. Solution

* Update to JNews 8.5.0 or latest.

# 6. Vulnerability Timeline

* September 01, 2015 — **Bug reported to Joobi**
* September 02, 2015 — **Joobi team** acknowledges the vulnerability
* September 20, 2015 — **Joobi team** releases a new version
* October 28, 2015 — **Public disclosure**

# 7. References

* [http://www.joobi.co/blog/jnews-8-5-x-released.html](http://www.joobi.co/blog/jnews-8-5-x-released.html)